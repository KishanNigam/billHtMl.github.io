Dim db, rs, db2, rs2

sDate = DatePart("yyyy", Now) 
RPTDATE = sDate
YYEAR= DatePart("yyyy", Now)  
mmno = DatePart("m", Now)
monthno = ZeroFill(mmno,2)
sDate = sDate & monthno   
RPTDATE = RPTDATE & "-" & monthno
ddno = DatePart("d", Now)
dayno = ZeroFill(ddno,2)
sDate = sDate & dayno  
RPTDATE = RPTDATE & "-" & dayno
hrs = DatePart("h", Now)
mns = DatePart("n", Now)
hrno = ZeroFill(hrs,2)
minno = ZeroFill(mns,2)
sDate = sDate & hrno & minno
NUMCKS = 0
AMTCKS = 0
TOTCKS = 0
TOTAMT = 0


   LOGFilePath = "\\bhsieas11\server\custom\log\SB-TestV01\OFAC_VBS_" & sDate & ".LOG"
   set objLOG = createobject("Scripting.FileSystemObject")
   set objLOGFile = objLOG.CreateTextfile(LOGFilePath)
   objLOGFile.WriteLine("OFAC EXPORT REPORT      RUN DATE: " & DATE & "  " & TIME)
   objLOGFile.WriteLine("   ")
   DATAFilePath = "\\bhsieas11\server\custom\log\SB-TestV01\BHSIEAS_Intl_" & sDate & ".TXT"

      set objDATA = createobject("Scripting.FileSystemObject")
      set objDATAFile = objDATA.CreateTextfile(DATAFilePath)
objLOGFile.WriteLine("File Created")
  


   sConnect = "DRIVER={SQL Server};SERVER=NICOSQL108\BHSIEAS_TEST;UID=SYSTEM;Trusted_Connection=yes;DATABASE=EAS;"
 

  objLOGFile.WriteLine("Connected")
Set db = CreateObject("ADODB.Connection")
db.CommandTimeout = 0
db.Open sConnect 


sQuery="SELECT DISTINCT " & _ 
			  "C.TIN AS DATA_FIELD " & _
         "FROM AP_BSTRN_HEADER C " & _
        "WHERE C.TRAN_ID   IN ( 121092,121093) " 
		  
		  

            
 
  
  'WScript.Echo sQuery

Set rs=db.execute(sQuery)

FIRSTR = "Y"
PREVBA = "Y"

On Error Resume Next
rs.MoveFirst
Do Until rs.EOF 
   objDATAFile.WriteLine(rs.Fields("DATA_FIELD"))
   NUMCKS = NUMCKS + 1
   rs.MoveNext
Loop

rs.Close
db.Close
Set rs = Nothing
Set db = Nothing


   objLOGFile.WriteLine("NUMBER OF CHECKS = " & NUMCKS)

Set db = CreateObject("ADODB.Connection")
db.CommandTimeout = 0
db.Open sConnect 



On Error Resume Next

rs.Close
db.Close
Set rs = Nothing
Set db = Nothing



   objLOGFile.WriteLine("  ")
   objLOGFile.WriteLine("OFAC EXPORT ENDED SUCCESSFULLY")


objDATAFile.Close
objLOGFile.Close

WScript.Quit(0)


Function ReadReg(RegPath)
     Dim objRegistry, Key
     Set objRegistry = CreateObject("Wscript.shell")
     Key = objRegistry.RegRead(RegPath)
     ReadReg = Key
End Function

Function ZeroFill (ByVal String, ByVal length )
     ZeroFill = Trim(String)
     Do While Len(ZeroFill) < length
         ZeroFill = "0" & ZeroFill
     Loop
End Function

Function BLANKFill (ByVal String, ByVal length )
     BLANKFill = Trim(String)
     Do While Len(BLANKFill) < length
         BLANKFill = " " & BLANKFill
     Loop
End Function


