Here is a concise **Technical Analysis Document** for the requested change:

---

### **Technical Analysis Document**  

#### **1. Objective**  
To enhance the existing batch file `RUN_BHSI-BAI2-IMPORT.bat` to copy the Posted Payment files to an additional location (Reporting Solution Directory) while maintaining the current functionality of moving files to the HSBC Payments Directory.

---

#### **2. Current Process**  
1. Posted Payment and Outstanding Payment files are saved under:
   - **Directory**:  
     `G:\Finance\BHSIC CASH\Daily_Feeds\HSBC_Data`
2. The batch file `RUN_BHSI-BAI2-IMPORT.bat` runs the following steps:
   - Executes `BKSTMT_IMPORT.VBS`
   - Executes `RRNG.exe`  
   - Executes `VALDLOAD.EXE`  
   - Moves payment files to their respective directories.

---

#### **3. Proposed Changes**  
Update the batch file to:
- **Copy** Posted Payment files to the Reporting Solution Directory (new location).  
- **Maintain** the existing functionality of moving files to the HSBC Payments Directory.  

---

#### **4. Implementation Details**  

##### **Code Update**  
1. **Added Step**:  
   - Copy the Posted Payment files to the Reporting Solution directory (`RSHSBCPaymentsDir`).
2. **Updated Section**:  
   Below is the updated code snippet with the new functionality:  

   ```bat
   REM Moving the HSBC Payments files to network location.
   echo Moving the HSBC Outstanding and Posted Payment files.                                                  >>%logfilename%
   echo Executing [MOVE %workdir%%HSBCOutstandngFiles% %HSBCPaymentsDir%].                                     >>%logfilename%
   IF EXIST %workdir%%HSBCOutstandngFiles% MOVE %workdir%%HSBCOutstandngFiles% %HSBCPaymentsDir%               >>%logfilename%
   echo Executing [COPY %workdir%%HSBCPostedFiles% %RSHSBCPaymentsDir%].                                       >>%logfilename%
   IF EXIST %workdir%%HSBCPostedFiles% COPY %workdir%%HSBCPostedFiles% %RSHSBCPaymentsDir%                     >>%logfilename%
   echo Executing [MOVE %workdir%%HSBCPostedFiles% %HSBCPaymentsDir%].                                         >>%logfilename%
   IF EXIST %workdir%%HSBCPostedFiles% MOVE %workdir%%HSBCPostedFiles% %HSBCPaymentsDir%                       >>%logfilename%
   echo Finished moving the HSBC Outstanding and Posted Payment files.                                         >>%logfilename%
   echo .  
   ```

---

#### **5. Key Variables**  
1. **Payment Directories**:  
   - `HSBCPaymentsDir`: Existing HSBC Payments Directory.  
   - `RSHSBCPaymentsDir`: New Reporting Solution Directory.  

2. **Posted Payment Directory Paths (for ENVIRONMENTS)**:  
   - **PROD**:  
     - Source: `G:\Finance\BHSIC CASH\Daily_Feeds\HSBC_Data`  
     - Destination: `G:\Finance\BHSIC CASH\Daily_Feeds\HSBC_Data\RptSln`  
   - **TEST**:  
     - Source: `G:\Finance\BHSIC CASH\Daily_Feeds\TEST\HSBC_Data`  
     - Destination: `G:\Finance\BHSIC CASH\Daily_Feeds\TEST\HSBC_Data\RptSln`  
   - **UAT**:  
     - Source: `G:\Finance\BHSIC CASH\Daily_Feeds\UAT\HSBC_Data`  
     - Destination: `G:\Finance\BHSIC CASH\Daily_Feeds\UAT\HSBC_Data\RptSln`  

---

#### **6. Testing Requirements**  
1. **Validation of File Copy Process**:  
   - Ensure that Posted Payment files are successfully copied to `RSHSBCPaymentsDir`.
   - Confirm that Outstanding Payments files remain unaffected.
2. **Validation of File Move Process**:  
   - Confirm that the Posted Payment files are moved to `HSBCPaymentsDir`.
3. **Environment Testing**:  
   - Test across all environments (PROD, TEST, UAT) with sample data.  

---

#### **7. Risks and Mitigations**  
- **Risk**: Duplication of files due to the copy command.  
  - **Mitigation**: Ensure accurate testing to validate that files are copied before being moved.  
- **Risk**: Directory path mismatch.  
  - **Mitigation**: Verify all directory paths before deployment.  

---

#### **8. Expected Output**  
1. Successful copying of Posted Payment files to the Reporting Solution Directory.  
2. Existing functionality of moving files to HSBC Payments Directory remains unaffected.  

---

#### **9. Approval and Deployment**  
- **Approvals Needed**:  
   - Testing Sign-off  
   - Deployment Sign-off  
- **Deployment Plan**:  
   - Update batch file on all environments.  
   - Run test cases in TEST and UAT before deploying to PROD.  

--- 

This document ensures alignment with the requested change and supports testing and deployment processes. Let me know if further details are needed!
