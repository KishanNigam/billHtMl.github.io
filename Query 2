' Existing Code
TRANNUM = FORMATNUMBER(MID(arr(1),TRANDEL + 7,TRANCHR),0,,,0)
WScript.Echo "Initial TRANNUM: " & TRANNUM

CUSTREF = "T" & MID(arr(1),TRANDEL + 7,TRANCHR)
CUSTREF = TRIM(CUSTREF)
WScript.Echo "Initial CUSTREF: " & CUSTREF

' New Logic Starts Here
IF LEN(TRANNUM) < 6 THEN
    WScript.Echo "TRANNUM length is less than 6, checking next line..."

    ' Read next line manually from file or array
    IF NOT objFile.AtEndOfStream THEN
        nextLine = objFile.ReadLine ' Read the next line
        WScript.Echo "Next Line Read: " & nextLine

        ' Check if next line starts with "88,"
        IF LEFT(nextLine, 3) = "88," THEN
            WScript.Echo "Next line starts with 88, processing..."

            nextValueStart = 4 ' Skipping "88,"
            nextValueEnd = INSTR(nextLine, "/") - 1 ' Find position of "/"
            WScript.Echo "Position of '/': " & nextValueEnd

            IF nextValueEnd > nextValueStart THEN
                additionalValue = MID(nextLine, nextValueStart, nextValueEnd - nextValueStart)
                WScript.Echo "Extracted Additional Value: " & additionalValue

                TRANNUM = TRANNUM & additionalValue
                WScript.Echo "Updated TRANNUM: " & TRANNUM

                CUSTREF = "T" & TRANNUM
                CUSTREF = TRIM(CUSTREF)
                WScript.Echo "Updated CUSTREF: " & CUSTREF
            ELSE
                WScript.Echo "No valid additional value found in next line."
            END IF
        ELSE
            WScript.Echo "Next line does not start with 88, skipping..."
        END IF
    ELSE
        WScript.Echo "End of file reached, no next line to read."
    END IF
END IF
' New Logic Ends Here
