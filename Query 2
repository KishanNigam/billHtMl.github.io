' Existing Code
TRANNUM = FORMATNUMBER(MID(arr(1),TRANDEL + 7,TRANCHR),0,,,0)
CUSTREF = "T" & MID(arr(1),TRANDEL + 7,TRANCHR)
CUSTREF = TRIM(CUSTREF)

' New Logic Starts Here
IF LEN(TRANNUM) < 6 THEN
    ' Check if next line exists and starts with "88,"
    IF UBOUND(arr) > 1 THEN
        nextLine = arr(2) ' Assuming arr(2) is the next line
        IF LEFT(nextLine, 3) = "88," THEN
            nextValueStart = 4 ' Skipping "88,"
            nextValueEnd = INSTR(nextLine, "/") - 1 ' Find position of "/"
            
            IF nextValueEnd > nextValueStart THEN
                additionalValue = MID(nextLine, nextValueStart, nextValueEnd - nextValueStart)
                TRANNUM = TRANNUM & additionalValue
                CUSTREF = "T" & TRANNUM
                CUSTREF = TRIM(CUSTREF)
            END IF
        END IF
    END IF
END IF
' New Logic Ends Here
